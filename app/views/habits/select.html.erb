<%= render 'shared/page_heading', title: "Select Habits", description: "Select a number of habits that you want to establish for yourself. You can adjust the schedule and the duration for each habit afterwards." do %>

<% end %>
<div class="grid ">
  <% if @goals.present? %>
    <%= form_with(url: clone_habits_path, method: "post") do |form| %>

      <% @goals.each do |goal_id, habits| %>
        <div class="mb-8">
        <div class="mb-4">
          <h3 class="mb-1"><%= habits.first.goal.title %></h3>
          <p class="text-sm text-gray-500"><%= habits.first.goal.description %></p>
        </div>
        <% habits.each_with_index do |habit,index| %>
          <label class="my-2 relative block rounded-lg border border-gray-300 bg-white shadow-sm px-6 py-4 cursor-pointer hover:border-gray-400 sm:flex sm:justify-between focus-within:ring-1 focus-within:ring-offset-2 focus-within:ring-gray-400" x-data="{ selected: false }">
            <input type="checkbox" name="habit_ids[]" x-model="selected" value="<%= habit.id %>" class="sr-only" aria-labelledby="server-size-0-label" aria-describedby="server-size-0-description-0 server-size-0-description-1">
            <div class="flex items-center">
              <div class="text-sm">
                <p  class="font-medium text-gray-900">
                  <%= habit.title %>
                </p>
                <% if habit.description.present? %>
                  <div class="text-gray-500 flex">
                    <%= habit.description %>
                  </div>
                <% end %>
              </div>
            </div>
            <div id="server-size-0-description-1" class="mt-2 flex text-sm sm:mt-0 sm:block sm:ml-4 sm:text-right">
              <div class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0">
                <i class="far fa-calendar-alt mr-2"></i>
                <p>
                  <%= habit.recurrence_on.map{|day| day.capitalize.slice(0,2)}.join(', ') %> at <%= habit.recurrence_at %>
                </p>
              </div>
              <div class="mt-2 flex items-center justify-end text-sm text-gray-500 sm:mt-0 ml-6">
                <i class="far fa-clock mr-2"></i>
                <p>
                  <%= habit.duration %> mins
                </p>
              </div>
            </div>
            <div :class="{ 'border-transparent': !selected, 'border-gray-900': selected }" class="absolute -inset-px rounded-lg border-2 pointer-events-none" aria-hidden="true"></div>
          </label>
        <% end %>
        </div>
      <% end %>
      <%= form.submit 'Select Habits', class: 'btn btn-primary' %>
    <% end %>
  <% else %>
    <p class="text-gray-500">There are currently no habits available as a template.</p>
  <% end %>
</div>